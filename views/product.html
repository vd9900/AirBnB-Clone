<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>house</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>
<!-- Basic style -->
<style>
    .img-container {
        margin: 20px auto;
        position: relative;
    }

    .btn-container {
        position: absolute;
        text-align: center;
        display: flex;
        justify-content: space-between;
        padding: 0 10px;
        top: 42%;
        width: 100%;
    }

    .img-container>img {
        height: 400px;
        width: 100%;
        display: block;
        margin: auto;
        padding-bottom: 20px;
    }

    .btn-container>button {
        outline: none;
        width: 40px;
        height: 40px;
        border: none;
        background-color: rgb(25, 121, 211);
        border-radius: 50%;
        color: white;
        cursor: pointer;
    }

    .btn-container>button:last-child {
        margin: 0 50px 0 0;
    }
</style>

<body>
    <section>

        <nav class="navbar navbar-expand-lg bg-light">
            <div class="container-fluid">
                <span><a href="http://localhost:4000/home"
                        class="text-decoration-none text-danger fs-2">AirBnB</a></span>
                <div class="ms-auto me-3">
                    <span class="w-70 me-3"><a href="/hoster">Become a hoster</a></span>
                    <button type="button" class="btn btn-outline-danger ms-2"><a href="/logout"
                            class="text-decoration-none text-dark">Logout</a></button>
                </div>
            </div>
        </nav>
        <div class="p-3">
            <!-- post component -->
            <div style="width:76vw;" class="bg-light m-auto px-3">
                <!-- post title -->
                <div class="row">
                    <div class="col">
                        <h1 class="propertyName"></h1>
                    </div>
                    <div class="col d-flex justify-content-end">
                        <h1><i class="fa-solid fa-indian-rupee-sign"></i>price: <span class="price"></span></h1>
                    </div>
                </div>
                <!-- place -->
                <h3><span class="city"></span> <span class="country"></span></h3>
                <!-- imgs -->
                <div style="width:700px;" id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner" id="images">

                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
                        data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
                        data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
                <!--  tumbmail -->
                <h2 class="my-4 mainTitle"></h2>
                <div class="pe-5">
                    <!-- detailed description -->
                    <p class="me-5 roomDescription">
                    </p>
                </div>
                <!--  guests, bedrooms beds bathrooms -->
                <div class="">
                    <!-- guests -->
                    <span class="me-2"> <span class="guest"></span>-guests</span>
                    <!-- bedrooms -->
                    <span> <span class="bedRooms"></span>-bedrooms</span>
                    <!-- beds -->
                    <span class="mx-2"> <span class="beds"></span>-beds</span>
                    <!-- bathrooms -->
                    <span><span class="bathRooms"></span>-bathrooms</span>
                </div>
                <!-- ratings -->
                <div class="my-3 fs-3">
                    Rating: <span id="rating"></span>/5
                </div>

                <!-- Amenities -->
                <h4>Amenities</h4>
                <div class="d-flex gap-3">
                    <!-- outdoor -->
                    <ul class="list-group" id="outdoor">
                        <li class="list-group-item bg-dark text-light fw-bold" aria-current="true">Outdoor
                        </li>
                        <!-- <li class="list-group-item">A second item</li>
                        <li class="list-group-item">A third item</li>
                        <li class="list-group-item">A fourth item</li>
                        <li class="list-group-item">And a fifth one</li> -->
                    </ul>
                    <!-- indoor -->
                    <ul class="list-group" id="indoor">
                        <li class="list-group-item bg-dark text-light fw-bold" aria-current="true">Indoor
                        </li>
                        <!-- <li class="list-group-item">A second item</li>
                        <li class="list-group-item">A third item</li>
                        <li class="list-group-item">A fourth item</li>
                        <li class="list-group-item">And a fifth one</li> -->
                    </ul>
                    <!-- Essentials -->
                    <ul class="list-group" id="essentials">
                        <li class="list-group-item bg-dark text-light fw-bold" aria-current="true">
                            Essentials</li>
                        <!-- <li class="list-group-item">A second item</li>
                        <li class="list-group-item">A third item</li>
                        <li class="list-group-item">A fourth item</li>
                        <li class="list-group-item">And a fifth one</li> -->
                    </ul>
                </div>

                <!-- hoster details -->
                <div style="height: 45px;" class="d-flex align-items-center border border-dark ps-3 mt-3 w-50">
                    <!-- user image -->
                    <!-- <span></span> -->
                    <!-- user name -->
                    <p class="m-0">Owner: <span class="ownerName"></span> </p>
                </div>
                <!-- booking form -->
                <div class="col-lg-5 col-md-12 my-3 border border-dark rounded">
                    <form class="mt-2 px-2" method="post" action="/property/bookingconf">
                        <div class="row">
                            <!-- alert here -->
                            <div class="col-12 showalert">

                            </div>
                            <!-- guest name -->
                            <div class="col-lg-12 col-md-12">
                                <label for="guestName" class="form-label">GuestName</label>
                                <input type="text" class="form-control" id="guestName" name="GuestName" required>
                            </div>
                            <!-- check in -->
                            <div class="col-6">
                                <label for="checkIn" class="form-label">Check in</label>
                                <input type="date" class="form-control" id="checkIn" name="CheckIn" required>
                            </div>
                            <!-- check out -->
                            <div class="col-6">
                                <label for="checkOut" class="form-label">Check out</label>
                                <input type="date" class="form-control" id="checkOut" name="CheckOut" required>
                            </div>
                        </div>
                        <!-- Nop -->
                        <div class="col-12 mt-3">
                            <label for="nop" class="form-label">No of person</label>
                            <input type="number" class="form-control" id="nop" name="Nop" required>
                        </div>
                        <!-- no of nights -->
                        <div class="col-lg-4 col-md-12 mt-3">
                            <label for="non" class="form-label">No of nights</label>
                            <input type="number" class="form-control" id="non" name="Non" required>
                        </div>
                        <!-- payment option -->
                        <div class="col-lg-12 col-md-12 mt-3">
                            <label for="payment" class="form-label">Payment option</label>
                            <select class="form-select" id="payment" name="Payment" required>
                                <option>Pay at property</option>
                                <option>Online payment</option>
                            </select>
                        </div>
                        <!-- submit -->
                        <div class="col-12 my-3">
                            <button class="btn btn-primary submitBtn" type="submit">Submit form</button>
                        </div>
                    </form>
                </div>
                <div class="container px-2 py-4" id="reviewcontainer">
                    <h3>feedback&reviews</h3>
                    <!-- <div class="container p-2 border border-3 border-dark w-50 ms-0 my-4"> -->

                    <!-- </div>   -->
                </div>
            </div>
        </div>
        </div>

    </section>
    <!-- Javascript code for  -->
    <script>
        // all elemenet to add value
        const propertyName = document.querySelector(".propertyName")
        const mainTitle = document.querySelector(".mainTitle")
        const ownerName = document.querySelector(".ownerName")
        const city = document.querySelector(".city")
        const state = document.querySelector(".state")
        const country = document.querySelector(".country")
        const price = document.querySelector(".price")
        const size = document.querySelector(".size")
        const guest = document.querySelector(".guest")
        const beds = document.querySelector(".beds")
        const bedRooms = document.querySelector(".bedRooms")
        const bathRooms = document.querySelector(".bathRooms")
        const roomDescription = document.querySelector(".roomDescription")
        const indoor = document.getElementById("indoor")
        const outdoor = document.getElementById("outdoor")
        const essentials = document.getElementById("essentials")
        const images = document.getElementById("images")
        const rating = document.getElementById("rating")



        //review container
        const reviewContainer = document.getElementById("reviewcontainer")
        async function fetchpropertydata() {
            try {
                // fetch data here
                const fetchs = await fetch('http://localhost:4000/fetchproperty');
                const reviewFetch = await fetch('http://localhost:4000/fetchreivewproduct');

                // convert  json to data
                const data = await fetchs.json();
                const reviewData = await reviewFetch.json();
                // fetching all product deatils
                propertyName.innerHTML = data.propertyName;
                mainTitle.innerHTML = data.mainTitle;
                ownerName.innerHTML = data.owner;
                price.innerHTML = data.price;
                roomDescription.innerHTML = data.roomDescription;
                guest.innerHTML = data.total.Allowedpeople;
                beds.innerHTML = data.total.Beds;
                bedRooms.innerHTML = data.total.Bedrooms;
                bathRooms.innerHTML = data.total.Bathrooms;
                console.log(reviewData);
                // console.log(data.roomImage);
                const realrating =  ()=>{
                    let total_user_rated = reviewData.length;
                    let total_rating =  reviewData[total_user_rated-1].totalrating;
                    let sum_of_max_rating_of_user_count = total_user_rated * 5;
                    return (total_rating * 5)/sum_of_max_rating_of_user_count;

                }
                console.log(realrating());
                rating.innerText = realrating()
                //fecthing amenitels
                //indoor
                images.innerHTML = `
                        <div class="carousel-item active">
                            <img src="./assets/${data.roomImage[0]}"
                                class="d-block w-100" alt="...">
                        </div>
                        <div class="carousel-item">
                            <img src="./assets/${data.roomImage[1]}"
                                class="d-block w-100" alt="...">
                        </div>
                        <div class="carousel-item">
                            <img src="./assets/${data.roomImage[2]}"
                                class="d-block w-100" alt="...">
                        </div>
                `
                for (let i = 0; i < data.amenities.indoor.length; i++) {
                    const li = document.createElement("li")
                    li.classList.add("list-group-item")
                    li.innerHTML = `${data.amenities.indoor[i]}`;
                    indoor.appendChild(li)

                }
                //outdoor
                for (let i = 0; i < data.amenities.outdoor.length; i++) {
                    const li = document.createElement("li")
                    li.classList.add("list-group-item")
                    li.innerHTML = `${data.amenities.outdoor[i]}`;
                    outdoor.appendChild(li)
                    console.log(li);

                }
                //essentials
                for (let i = 0; i < data.amenities.essentials.length; i++) {
                    const li = document.createElement("li")
                    li.classList.add("list-group-item")
                    li.innerHTML = `${data.amenities.essentials[i]}`;
                    essentials.appendChild(li)

                }





                if (reviewData.length == 0) {
                    const div = document.createElement("div")
                    div.classList.add("d-flex", "justify-content-center")
                    div.innerHTML = `<h4>No commits yet</h4>`
                    reviewContainer.appendChild(div)
                }

                // review container
                for (let i = 0; i < reviewData.length; i++) {
                    const div = document.createElement("div")
                    const updatedTime = new Date(reviewData[i].updated)
                    div.classList.add("container", "p-2", "border", "border-dark", "w-50", "ms-0", "mt-4")
                    div.innerHTML = `
                    <p class="mb-0">
                           UserName: <b>
                               <span>${reviewData[i].userName}</span>

                           </b>
                       </p>
                       <p class="mb-0">
                        description: <span>${reviewData[i].Description}</span>
                       </p> 
                       <p class="mb-0">
                        posted on: <span>${(updatedTime.getDate() > 10 ? updatedTime.getDate() : `0${updatedTime.getDate()}`)}-${updatedTime.getMonth() + 1}-${updatedTime.getFullYear()}</span>
                       </p> 
                    `
                    reviewContainer.appendChild(div)
                }
            }
            catch (err) {
                // err
                console.log(err, "sladklksdfajdsklfjsdfkl")
            }
        }
        fetchpropertydata()
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
        crossorigin="anonymous"></script>
</body>

</html>